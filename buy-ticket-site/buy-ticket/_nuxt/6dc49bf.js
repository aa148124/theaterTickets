(window.webpackJsonp=window.webpackJsonp||[]).push([[9,4],{347:function(t,e,n){"use strict";n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return m})),n.d(e,"e",(function(){return h}));var r=n(10),o=n(349),c=n.n(o);function l(t,e,n){return Object(r.a)({url:"/order/getOrdersByUserId/".concat(t,"/").concat(e,"/").concat(n),method:"get"})}function d(t){return Object(r.a)({url:"/order/getOrderTotalByUserId/".concat(t),method:"get"})}function v(t){return Object(r.a)({url:"/order/addOrder",method:"post",data:t})}function m(t){return Object(r.a)({url:"/order/getOrderById/".concat(t),method:"get"})}function h(data){return Object(r.a)({url:"/order/pay",method:"put",headers:{"content-type":"application/x-www-form-urlencoded"},data:c.a.stringify(data)})}},348:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c}));var r=n(10);function o(t){return Object(r.a)({url:"/arrange/getArrangeByFilmId/".concat(t),method:"get"})}function c(t){return Object(r.a)({url:"/arrange/getArrangeById/".concat(t),method:"get"})}},352:function(t,e){},356:function(t,e,n){"use strict";n.r(e);n(207);var r=n(348),o=n(347),c={data:function(){return{tableData:[{filmName:"",date:"",roomName:"",seat:""}],orderId:"",sum:0,order:{},arrangeId:"",arrange:{},filmName:"",pay:{id:""}}},created:function(){this.Time()},mounted:function(){this.init()},methods:{init:function(){var t=this,e=window.location.href;this.orderId=e.split("=")[1],o.b(this.orderId).then((function(e){200==e.code&&(t.order=e.data.order,t.sum=e.data.time,console.log(t.order),t.arrangeId=t.order.arrangeId,t.tableData[0].seat=t.order.seat,console.log(t.tableData),r.b(t.arrangeId).then((function(e){200==e.code&&(t.tableData[0].roomName=e.data.room.roomName,t.tableData[0].filmName=e.data.film.filmName,t.tableData[0].date=e.data.playTime,console.log(e.data))})))}))},submit:function(){var t=this;this.pay.id=this.orderId,o.e(this.pay).then((function(e){200==e.code&&(t.$message.success("支付成功"),t.$router.push({name:"profile",params:{activeIndex:"1"}}))})).catch((function(e){t.$message.error(e.msg)}))},Time:function(){var t=this;setInterval((function(){t.sum>0&&(t.sum-=1)}),1e3)}}},l=n(13),component=Object(l.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"margin-bottom":"100px","margin-top":"20px"}},[e("div",[e("el-steps",{attrs:{active:2,"align-center":""}},[e("el-step",{attrs:{title:"选择影片场次"}}),t._v(" "),e("el-step",{attrs:{title:"选择座位"}}),t._v(" "),e("el-step",{attrs:{title:"15分钟内付款"}}),t._v(" "),e("el-step",{attrs:{title:"影院取票观影"}})],1)],1),t._v(" "),e("div",{staticStyle:{"justify-content":"center",display:"flex",margin:"40px 0 40px 0"}},[e("div",{staticClass:"pay-mid"},[e("div",{staticStyle:{margin:"40px",display:"flex"}},[t._m(0),t._v(" "),e("div",[e("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("\n            请在"+t._s(parseInt(t.sum/60))+"分钟"+t._s(t.sum%60)+"秒内完成支付\n          ")]),t._v(" "),e("div",{staticStyle:{color:"#f03d37"}},[t._v("\n            超时订单会自动取消，如遇支付问题，请致电猫眼客服:1010-533\n          ")])])])])]),t._v(" "),t._m(1),t._v(" "),e("div",{staticStyle:{"justify-content":"center",display:"flex"}},[e("div",{staticStyle:{width:"1200px"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{prop:"filmName",label:"影片",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{prop:"date",label:"时间",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{prop:"roomName",label:"影厅",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{prop:"seat",label:"座位",align:"center"}})],1)],1)]),t._v(" "),e("div",{staticStyle:{"justify-content":"center",display:"flex","margin-top":"100px"}},[e("div",{staticStyle:{width:"1200px"}},[e("div",{staticStyle:{float:"right"}},[t._v("实际支付:"+t._s(t.order.price)+"元")])])]),t._v(" "),e("div",{staticStyle:{"justify-content":"center",display:"flex","margin-top":"20px"}},[e("div",{staticStyle:{width:"1200px"}},[e("div",{staticStyle:{float:"right"}},[e("el-button",{attrs:{type:"danger",round:""},on:{click:function(e){return t.submit()}}},[t._v("确认支付")])],1)])])])}),[function(){var t=this._self._c;return t("div",{staticStyle:{"margin-right":"20px"}},[t("img",{attrs:{src:"https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/b681f7e04b084228b25153d9e91003a4.jpg"}})])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"justify-content":"center",display:"flex",margin:"10px 0 10px 0"}},[e("div",{staticStyle:{width:"1200px"}},[t._v("\n      请仔细核对场次信息，出票后将"),e("span",{staticStyle:{color:"#faaf00"}},[t._v("无法退票和改签")])])])}],!1,null,null,null);e.default=component.exports},372:function(t,e,n){"use strict";n.r(e);n(207),n(69);var r=n(11),o=n.n(r),c=(n(356),n(347)),l=n(144),d=n(348),v={data:function(){return{filmId:"",film:{},imgSrc:"",tableData:[],arrange:{},seat:[],selected:"",price:0,count:0,order:{arrangeId:"",seat:"",price:0},user:{}}},created:function(){},mounted:function(){this.init()},methods:{init:function(){var t=this;o.a.get("token")&&(this.user=JSON.parse(o.a.get("user")));var e=window.location.href;this.filmId=e.split("&")[0].split("=")[1],this.order.arrangeId=e.split("&")[1].split("=")[1],l.a(this.filmId).then((function(e){200==e.code&&(t.film=e.data)})),d.b(this.order.arrangeId).then((function(e){200==e.code&&(t.arrange=e.data,t.seat=t.arrange.seat.split(","),t.order.arrangeId=t.arrange.id)}))},toPay:function(){c.a(this.order).then((function(t){200==t.code&&(window.location.href="/buy/pay?orderId="+t.data.id)}))},selectSeat:function(i,t){var img=document.getElementsByTagName("input")[i*this.seat[i].length+t+1];if("0"==this.seat[i][t]){if(4==this.count)return void this.$message.error("最多只能选4个座为哦");this.count++,this.order.price+=this.arrange.price,this.order.seat+=i+1+"排"+(t+1)+"座 ",console.log(this.order.seat),this.seat[i]=this.seat[i].substr(0,t)+"2"+this.seat[i].substr(t+1,this.seat[i].length),img.src="https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%B7%B2%E9%80%89.png"}else{this.count--,this.order.price-=this.arrange.price;var e=i+1+"排"+(t+1)+"座 ";this.order.seat=this.order.seat.replace(e,""),this.seat[i]=this.seat[i].substr(0,t)+"0"+this.seat[i].substr(t+1,this.seat[i].length),img.src="https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%8F%AF%E9%80%89.png"}}}},m=n(13),component=Object(m.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"margin-bottom":"100px","margin-top":"20px"}},[e("div",[e("el-steps",{attrs:{active:1,"align-center":""}},[e("el-step",{attrs:{title:"选择影片场次"}}),t._v(" "),e("el-step",{attrs:{title:"选择座位"}}),t._v(" "),e("el-step",{attrs:{title:"15分钟内付款"}}),t._v(" "),e("el-step",{attrs:{title:"影院取票观影"}})],1)],1),t._v(" "),e("div",{staticClass:"seat"},[e("div",{staticClass:"seat-size"},[e("div",{staticClass:"seatleft"},[t._m(0),t._v(" "),e("div",{staticClass:"seat-bottom"},[e("div",{staticClass:"seat-bottom-left"},t._l(12,(function(n){return e("div",{key:n},[e("div",[t._v(t._s(n))])])})),0),t._v(" "),e("div",[t._m(1),t._v(" "),e("div",{staticStyle:{"justify-content":"center",display:"flex","margin-bottom":"50px"}},[t._v("\n              银幕中央\n            ")]),t._v(" "),e("div",t._l(t.seat,(function(i,n){return e("div",{key:n+"-label",staticStyle:{"justify-content":"center",display:"flex"}},t._l(i,(function(r,o){return e("div",{key:o+"-label2"},["0"==r?e("input",{staticStyle:{margin:"0px 5px"},attrs:{type:"image",src:"https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%8F%AF%E9%80%89.png"},on:{click:function(e){return t.selectSeat(n,o)}}}):"1"==r?e("input",{staticStyle:{margin:"0px 5px"},attrs:{type:"image",src:"https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%B7%B2%E5%94%AE.png",disabled:""}}):"2"==r?e("input",{staticStyle:{margin:"0px 5px"},attrs:{type:"image",src:"https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%B7%B2%E9%80%89.png"},on:{click:function(e){return t.selectSeat(n,o)}}}):t._e()])})),0)})),0)])])]),t._v(" "),e("div",{staticClass:"seatright"},[e("div",{staticStyle:{display:"flex"}},[e("div",[e("img",{attrs:{src:t.film.poster}})]),t._v(" "),e("div",{staticStyle:{"margin-left":"20px"}},[e("div",{staticStyle:{"font-size":"20px","font-weight":"700",color:"#333",margin:"0 0 14px"}},[t._v("\n              "+t._s(t.film.filmName)+"\n            ")]),t._v(" "),e("div",[t._v("导演："+t._s(t.film.director))]),t._v(" "),e("div",[t._v("演员："+t._s(t.film.performer))]),t._v(" "),e("div",[t._v("时长："+t._s(t.film.duration)+"分钟")])])]),t._v(" "),e("div",{staticStyle:{"margin-top":"20px"}},[e("div",{staticStyle:{"margin-bottom":"10px"}}),t._v(" "),e("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("场次："+t._s(t.arrange.playTime))]),t._v(" "),e("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("票价："+t._s(t.arrange.price)+"/张")])]),t._v(" "),e("hr",{staticStyle:{border:"1px dashed #e5e5e5"}}),t._v(" "),e("div",{staticStyle:{height:"160px"}},[e("div",[t._v("座位：一次最多选4个座位")]),t._v(" "),e("div",{staticStyle:{height:"120px"}},[t._v(t._s(t.order.seat))]),t._v(" "),e("div",[t._v("总价："+t._s(t.order.price)+"元")])]),t._v(" "),e("hr",{staticStyle:{border:"1px dashed #e5e5e5"}}),t._v(" "),e("div",{staticStyle:{"justify-content":"center",display:"flex","margin-top":"20px"}},[e("div",[e("div",{staticStyle:{margin:"30px"}},[t._v("手机号："+t._s(t.user.phone))]),t._v(" "),e("div",{staticStyle:{margin:"30px"}},[e("el-button",{attrs:{type:"danger",round:""},on:{click:function(e){return t.toPay()}}},[t._v("确认选座")])],1)])])])])])])}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"seatleft-top"},[e("div",[e("img",{attrs:{src:"\n            https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%8F%AF%E9%80%89.png"}}),e("span",[t._v("可选座位")])]),t._v(" "),e("div",[e("img",{attrs:{src:"https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%B7%B2%E5%94%AE.png"}}),e("span",[t._v("已售座位")])]),t._v(" "),e("div",[e("img",{attrs:{src:"https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E5%B7%B2%E9%80%89.png"}}),e("span",[t._v("已选座位")])])])},function(){var t=this._self._c;return t("div",[t("img",{attrs:{src:"https://dengkunhou.oss-cn-guangzhou.aliyuncs.com/%E9%93%B6%E5%B9%95.png"}})])}],!1,null,null,null);e.default=component.exports}}]);